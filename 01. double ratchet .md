Instant messaging in messaging apps allows conversations to take place over the internet even when one party’s phone is off or communication is asynchronous. In such situations, there may be long delays, sometimes months, between messages. These delays give attackers more time to break encryption keys and also increase the chance that users forget or lose keys, making messages unreadable. So far, only part of the process has been covered. Pre-key bundles and the initial Triple Diffie–Hellman key exchange are used to establish keys asynchronously. One possible approach is to use that initial key to secure every message, similar to online shopping on the internet. However, this is insecure. If a conversation lasts for months and an attacker records all messages, breaking a single key would expose the entire conversation because the same key is reused. Therefore, the key must be updated continuously instead of being reused.
